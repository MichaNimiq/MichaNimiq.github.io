<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nimiq Hub Integration</title>
    <!-- Include the Hub API from the CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@nimiq/hub-api@v1.2.3/dist/standalone/HubApi.standalone.umd.js" integrity="sha256-5X6zryCUAPOnfjLU8tEtJrLdcslA2UI27RsUWnLAxHs=" crossorigin="anonymous"></script>
</head>
<body>

Your address: <span id="output">-</span>
<button id="choose-address">Choose Address</button>
<button id="create-account">Create Account</button>
<button id="send-nim">Send NIM</button>
<button id="receive-nim">Receive NIM</button>

<script>
    // Initialize the Hub API for the testnet (for mainnet use 'https://hub.nimiq.com')
    const hubApi = new HubApi('https://hub.nimiq-testnet.com');

    // Choose an address
    document.getElementById('choose-address').addEventListener('click', async function(event) {
        const output = document.getElementById('output');

        try {
            const result = await hubApi.chooseAddress({ appName: 'Nimiq App' });
            output.textContent = result.address;
        } catch (error) {
            output.textContent = error.message;
        }
    });

    // Create a new account
    document.getElementById('create-account').addEventListener('click', async function() {
        const output = document.getElementById('output');

        try {
            const result = await hubApi.create();
            output.textContent = `New Account: ${result.address}`;
        } catch (error) {
            output.textContent = error.message;
        }
    });

    // Send NIM
    document.getElementById('send-nim').addEventListener('click', async function() {
        const recipientAddress = prompt('Enter recipient address:');
        const amount = parseFloat(prompt('Enter amount to send:'));

        if (!recipientAddress || isNaN(amount)) {
            alert('Invalid input');
            return;
        }

        try {
            const result = await hubApi.checkout({
                appName: 'Nimiq App',
                recipient: recipientAddress,
                value: amount * 1e5,  // Convert NIM to Luna
            });
            output.textContent = 'Transaction successful!';
        } catch (error) {
            output.textContent = error.message;
        }
    });

    // Receive NIM
    document.getElementById('receive-nim').addEventListener('click', async function() {
        const output = document.getElementById('output');

        try {
            const result = await hubApi.receive({
                appName: 'Nimiq App',
            });
            output.textContent = `Receive address: ${result.address}`;
        } catch (error) {
            output.textContent = error.message;
        }
    });

</script>

</body>
</html>
